{
    "$jsonSchema": {
        "bsonType": "object",
        "required": ["email", "hash", "salt", "validated"],
        "additionalProperties": false,
        "properties": {
            "_id": {
                "bsonType": "objectId"
            },
            "email": {
                "bsonType": "string",
                "description": "email address of the user; uniquely identifies this document",
                "pattern": "^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$"
            },
            "hash": {
                "bsonType": "string",
                "description": "salted and hash user password stored in hexadecimal",
                "minLength": 64,
                "pattern": "[0-9a-fA-F]+"
            },
            "salt": {
                "bsonType": "string",
                "description": "salt used in password hash",
                "minLength": 64,
                "pattern": "[0-9a-fA-F]+"
            },
            "validated": {
                "bsonType": "bool",
                "description": "whether the email address has been validated"
            },
            "ts_updated": {
                "bsonType": "timestamp",
                "description": "if exists, represents the last time a change was made to the document"
            }
        }
    }
}